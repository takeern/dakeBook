!function(s){function e(e){for(var t,a,n=e[0],o=e[1],r=e[2],i=0,l=[];i<n.length;i++)a=n[i],u[a]&&l.push(u[a][0]),u[a]=0;for(t in o)Object.prototype.hasOwnProperty.call(o,t)&&(s[t]=o[t]);for(d&&d(e);l.length;)l.shift()();return h.push.apply(h,r||[]),c()}function c(){for(var e,t=0;t<h.length;t++){for(var a=h[t],n=!0,o=1;o<a.length;o++){var r=a[o];0!==u[r]&&(n=!1)}n&&(h.splice(t--,1),e=i(i.s=a[0]))}return e}var a={},u={0:0},h=[];function i(e){if(a[e])return a[e].exports;var t=a[e]={i:e,l:!1,exports:{}};return s[e].call(t.exports,t,t.exports,i),t.l=!0,t.exports}i.m=s,i.c=a,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(a,n,function(e){return t[e]}.bind(null,n));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/dist";var t=window.webpackJsonp=window.webpackJsonp||[],n=t.push.bind(t);t.push=e,t=t.slice();for(var o=0;o<t.length;o++)e(t[o]);var d=n;h.push([201,1]),c()}({100:function(e,t){},120:function(e,t,a){},123:function(e,t){!function(i){var e,l='<svg><symbol id="icon-tianqitubiao_qingtianbai" viewBox="0 0 1024 1024"><path d="M929.355 528.027h-47.046c-12.992 0-23.525-10.532-23.525-23.524s10.533-23.524 23.525-23.524h47.046c12.992 0 23.525 10.532 23.525 23.524s-10.532 23.524-23.525 23.524z m-46.954-211.079l-40.744 23.524c-11.251 6.496-25.639 2.642-32.134-8.61-6.496-11.251-2.642-25.639 8.61-32.135l40.744-23.524c11.251-6.495 25.639-2.641 32.135 8.611 6.494 11.252 2.64 25.638-8.611 32.134z m-376.005 493.28c-162.398 0-294.048-131.65-294.048-294.048s131.65-294.048 294.048-294.048 294.048 131.65 294.048 294.048-131.65 294.048-294.048 294.048z m0-529.286c-129.918 0-235.238 105.32-235.238 235.238s105.32 235.238 235.238 235.238 235.238-105.32 235.238-235.238-105.319-235.238-235.238-235.238z m206.277-82.571c-6.496 11.251-20.883 15.106-32.134 8.61-11.251-6.496-15.107-20.882-8.611-32.134l23.524-40.746c6.496-11.25 20.883-15.106 32.134-8.61 11.251 6.496 15.107 20.883 8.611 32.135l-23.524 40.745z m-206.277-35.048c-12.992 0-23.524-10.532-23.524-23.524V92.752c0-12.992 10.532-23.524 23.524-23.524S529.92 79.76 529.92 92.752V139.8c0 12.991-10.532 23.523-23.524 23.523z m-172.641 49.262c-11.251 6.496-25.639 2.641-32.135-8.611l-23.524-40.744c-6.496-11.251-2.642-25.637 8.61-32.134 11.251-6.496 25.639-2.642 32.135 8.61l23.524 40.744c6.496 11.252 2.64 25.639-8.61 32.135zM176.739 350.179l-40.744-23.524c-11.251-6.496-15.106-20.882-8.611-32.134 6.497-11.251 20.884-15.106 32.135-8.611l40.744 23.524c11.251 6.496 15.107 20.883 8.611 32.135-6.496 11.251-20.883 15.106-32.135 8.61z m-11.524 165.532c0 12.992-10.532 23.525-23.524 23.525H94.645c-12.992 0-23.525-10.533-23.525-23.525 0-12.991 10.533-23.523 23.525-23.523h47.046c12.992 0 23.524 10.532 23.524 23.523z m-23.616 187.555l40.744-23.524c11.251-6.495 25.637-2.641 32.135 8.611 6.495 11.251 2.641 25.639-8.611 32.133l-40.744 23.524c-11.251 6.496-25.639 2.642-32.134-8.61-6.497-11.251-2.641-25.638 8.61-32.134z m169.728 118.578c6.496-11.251 20.882-15.106 32.134-8.61 11.251 6.496 15.107 20.882 8.611 32.133l-23.524 40.744c-6.496 11.251-20.883 15.107-32.135 8.611-11.25-6.496-15.106-20.883-8.61-32.135l23.524-40.743z m206.277 35.048c12.992 0 23.524 10.532 23.524 23.524v47.048c0 12.992-10.532 23.524-23.524 23.524-12.991 0-23.523-10.532-23.523-23.524v-47.048c0-12.992 10.532-23.524 23.523-23.524z m172.642-49.262c11.251-6.496 25.637-2.642 32.134 8.61l23.524 40.744c6.496 11.251 2.641 25.639-8.61 32.135-11.251 6.496-25.639 2.641-32.135-8.61l-23.524-40.746c-6.496-11.251-2.641-25.638 8.611-32.133z m157.015-137.594l40.744 23.524c11.251 6.495 15.106 20.882 8.61 32.134-6.495 11.251-20.882 15.106-32.134 8.61l-40.744-23.524c-11.251-6.496-15.106-20.882-8.611-32.134 6.496-11.251 20.883-15.106 32.135-8.61z" fill="#7ECEF4" ></path></symbol><symbol id="icon-qingtianyewan" viewBox="0 0 1024 1024"><path d="M818.7 671.1c-184.7 0-334.4-149.7-334.4-334.4-0.1-55.5 13.7-110.1 40.1-158.9-181.1 4.1-326.8 151.9-326.8 334 0 184.7 149.7 334.4 334.4 334.4 127.2 0 237.8-71 294.3-175.6-2.5 0.1-5 0.5-7.6 0.5z" fill="#FFD81A" ></path></symbol><symbol id="icon-mulu" viewBox="0 0 1024 1024"><path d="M91.89 238.457c-29.899 0-54.133 24.239-54.133 54.134 0 29.899 24.234 54.137 54.133 54.137s54.138-24.238 54.138-54.137c0-29.896-24.239-54.134-54.138-54.134z" fill="#E5594F" ></path><path d="M91.89 462.463c-29.899 0-54.133 24.239-54.133 54.139 0 29.895 24.234 54.133 54.133 54.133s54.138-24.238 54.138-54.133c0-29.9-24.239-54.139-54.138-54.139z" fill="#C45FA0" ></path><path d="M91.89 686.475c-29.899 0-54.133 24.237-54.133 54.133 0 29.899 24.234 54.138 54.133 54.138s54.138-24.238 54.138-54.138c0-29.896-24.239-54.133-54.138-54.133z" fill="#F39A2B" ></path><path d="M941.26 234.723H328.964c-28.867 0-52.263 23.4-52.263 52.268v3.734c0 28.868 23.396 52.269 52.263 52.269H941.26c28.869 0 52.269-23.401 52.269-52.269v-3.734c-0.001-28.868-23.4-52.268-52.269-52.268z" fill="#F0D043" ></path><path d="M941.26 682.74H328.964c-28.867 0-52.263 23.399-52.263 52.268v3.734c0 28.863 23.396 52.269 52.263 52.269H941.26c28.869 0 52.269-23.405 52.269-52.269v-3.734c-0.001-28.868-23.4-52.268-52.269-52.268z" fill="#4A5699" ></path><path d="M709.781 458.729H328.964c-28.867 0-52.263 23.4-52.263 52.269v3.734c0 28.873 23.396 52.269 52.263 52.269h380.817c28.866 0 52.271-23.396 52.271-52.269v-3.734c0.001-28.869-23.405-52.269-52.271-52.269z" fill="#E5594F" ></path></symbol><symbol id="icon-shezhi" viewBox="0 0 1024 1024"><path d="M830.976 465.8432a42.368 42.368 0 0 0-29.5168-32.384l-10.88-2.432a107.5968 107.5968 0 0 1-73.4464-128.256l3.328-10.1888a44.3648 44.3648 0 0 0-12.1856-43.0592 300.416 300.416 0 0 0-39.2704-25.9584c-13.184-7.68-26.9056-14.4384-41.0624-20.1728a44.3648 44.3648 0 0 0-44.3648 10.6496l-7.552 7.9872a106.9312 106.9312 0 0 1-73.8816 29.2864 107.1616 107.1616 0 0 1-73.216-29.5168l-7.3216-7.7568a44.3648 44.3648 0 0 0-44.3648-10.6496 314.624 314.624 0 0 0-40.3712 20.1728c-13.5424 7.6288-26.4448 16.3072-38.6048 25.9584a44.3648 44.3648 0 0 0-11.5456 43.0592l3.0976 10.1888a107.8272 107.8272 0 0 1-11.52 79.0016 103.168 103.168 0 0 1-61.2352 48.5888l-10.4448 2.432a37.7088 37.7088 0 0 0-28.3904 30.3872c-1.9968 15.3088-2.816 30.72-2.432 46.1568-0.4352 15.7184 0.384 31.4368 2.432 47.0272a42.5984 42.5984 0 0 0 27.52 33.28l10.1888 2.4576a105.6 105.6 0 0 1 61.4656 50.1248c13.8496 23.8848 17.9712 52.1728 11.52 79.0016l-2.2016 9.984a44.3648 44.3648 0 0 0 12.6464 43.0336c11.8784 9.6768 24.4992 18.432 37.7088 26.1888 13.1328 7.9872 26.8544 14.9504 41.0624 20.8384 15.616 4.9152 32.6656 0.8192 44.3648-10.6496l7.0912-7.7568a107.8272 107.8272 0 0 1 148.4288 0l7.1168 7.7568a44.3648 44.3648 0 0 0 44.3648 10.6496 314.8288 314.8288 0 0 0 39.7056-20.8384 289.9712 289.9712 0 0 0 39.0656-25.9584c11.6736-11.008 16.512-27.4688 12.6464-43.0592l-3.1232-10.4192a107.5968 107.5968 0 0 1 74.112-128l10.2144-2.4576a42.368 42.368 0 0 0 29.4912-32.384c1.792-15.3344 2.3808-30.7456 1.792-46.1568a310.6048 310.6048 0 0 0-2.4576-46.1568z m-327.936 203.6736a157.5168 157.5168 0 1 1 0-315.0336 157.5168 157.5168 0 0 1 0 315.0336z" fill="#27AD9A" ></path></symbol><symbol id="icon-search" viewBox="0 0 1024 1024"><path d="M0 425.621165C0 660.359055 190.980031 851.129449 425.516346 851.129449c108.052157 0 206.896378-40.629417 282.067654-107.221669l271.182614 271.182614a25.511307 25.511307 0 0 0 18.222362 7.538897c6.692283 0 13.191055-2.507591 18.222363-7.538897a25.527433 25.527433 0 0 0 0-36.227024L743.811024 707.688819c66.600315-75.171276 107.221669-173.805858 107.221669-282.067654 0-234.745953-190.980031-425.516346-425.516347-425.516346S0 190.875213 0 425.621165z m799.727874 0c0 206.267465-167.952126 374.203465-374.211528 374.203465-206.267465 0-374.211528-167.936-374.211527-374.203465 0-206.267465 167.944063-374.211528 374.203464-374.211527 206.275528 0 374.219591 167.734425 374.219591 374.203464z" fill="#20A0FF" ></path></symbol><symbol id="icon-xiazai" viewBox="0 0 1039 1024"><path d="M422.327684 877.438795c-190.915254 0-347.118644-156.20339-347.118644-347.118644s156.20339-347.118644 347.118644-347.118644c169.702448 0 314.335217 121.491525 343.26177 289.265536 3.856874 21.212806-11.570621 40.497175-30.854991 44.354049-21.212806 3.856874-40.497175-11.570621-44.354049-30.85499-21.212806-131.13371-133.062147-225.627119-266.124293-225.627119-148.489642 0-269.981168 121.491525-269.981168 269.981168s121.491525 269.981168 269.981168 269.981167c21.212806 0 38.568738 17.355932 38.568738 38.568738s-19.284369 38.568738-40.497175 38.568739z" fill="#388CEB" ></path><path d="M730.877589 877.438795h-308.549905c-21.212806 0-38.568738-17.355932-38.568739-38.568739s17.355932-38.568738 38.568739-38.568738h308.549905c63.638418 0 115.706215-52.067797 115.706215-115.706214v-38.568739c0-63.638418-52.067797-115.706215-115.706215-115.706214-21.212806 0-38.568738-17.355932-38.568738-38.568739s17.355932-38.568738 38.568738-38.568738c106.06403 0 192.843691 86.779661 192.843692 192.843691v38.568739c0 106.06403-86.779661 192.843691-192.843692 192.843691z" fill="#388CEB" ></path><path d="M441.612053 646.026365c-21.212806 0-38.568738-17.355932-38.568738-38.568738v-173.559322c0-21.212806 17.355932-38.568738 38.568738-38.568738s38.568738 17.355932 38.568738 38.568738v173.559322c0 21.212806-17.355932 38.568738-38.568738 38.568738z" fill="#E78E00" ></path><path d="M441.612053 721.235405c-9.642185 0-19.284369-3.856874-26.998117-11.570622l-136.919021-136.91902c-15.427495-15.427495-15.427495-38.568738 0-53.996234 15.427495-15.427495 38.568738-15.427495 53.996234 0l109.920904 109.920904 106.06403-106.06403c15.427495-15.427495 38.568738-15.427495 53.996233 0 15.427495 15.427495 15.427495 38.568738 0 53.996234l-133.062147 133.062146c-7.713748 7.713748-17.355932 11.570621-26.998116 11.570622z" fill="#E78E00" ></path></symbol></svg>';if((e=document.getElementsByTagName("script"))[e.length-1].getAttribute("data-injectcss")&&!i.__iconfont__svg__cssinject__){i.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(e){console&&console.log(e)}}!function(t){if(document.addEventListener)if(~["complete","loaded","interactive"].indexOf(document.readyState))setTimeout(t,0);else{document.addEventListener("DOMContentLoaded",function e(){document.removeEventListener("DOMContentLoaded",e,!1),t()},!1)}else document.attachEvent&&(e=t,a=i.document,n=!1,o=function(){n||(n=!0,e())},(r=function(){try{a.documentElement.doScroll("left")}catch(e){return void setTimeout(r,50)}o()})(),a.onreadystatechange=function(){"complete"==a.readyState&&(a.onreadystatechange=null,o())});var e,a,n,o,r}(function(){var e,t,a,n,o,r;(e=document.createElement("div")).innerHTML=l,l=null,(t=e.getElementsByTagName("svg")[0])&&(t.setAttribute("aria-hidden","true"),t.style.position="absolute",t.style.width=0,t.style.height=0,t.style.overflow="hidden",a=t,(n=document.body).firstChild?(o=a,(r=n.firstChild).parentNode.insertBefore(o,r)):n.appendChild(a))})}(window)},196:function(e,t,a){},197:function(e,t,a){},201:function(e,t,a){"use strict";a.r(t);var n,o,r,i=a(0),h=a.n(i),l=a(68),s=a.n(l),c=a(33),u=a(203),d=a(18),b=a(27),p=a(98),f=a(39),m=a(28),v=a.n(m),g={message:"Hello Duck",poweredBy:"thanks for fire！",img_src:null},k="SET_LOCALDB",y="CHANGE_LOADING_STATE",w={isLoading:!1},S=a(100),x=a.n(S),C=Object(b.combineReducers)({home:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:g,t=1<arguments.length?arguments[1]:void 0;switch(t.type){case"GOT_LOGO_SRC":return v()({},e,{img_src:t.payload});default:return e}},init:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:w,t=1<arguments.length?arguments[1]:void 0;switch(t.type){case k:return v()({},e,{localDb:t.payload.db,storageProps:t.payload.localProps});case y:return v()({},e,{isLoading:t.payload});default:return e}},read:x.a}),E=a(14),D=a(2),T=a.n(D),N=a(3),B=a.n(N),O=a(8),j=a.n(O),_=a(9),I=a.n(_),z=a(10),A=a.n(z),L=(a(120),Object(d.connect)(function(e){return{isLoading:e.init.isLoading}})(n=function(e){function t(){return T()(this,t),j()(this,I()(t).apply(this,arguments))}return A()(t,e),B()(t,[{key:"render",value:function(){return this.props.isLoading?h.a.createElement("div",{class:"loader"},h.a.createElement("div",{class:"loader-line-wrap"},h.a.createElement("div",{class:"loader-line"})),h.a.createElement("div",{class:"loader-line-wrap"},h.a.createElement("div",{class:"loader-line"})),h.a.createElement("div",{class:"loader-line-wrap"},h.a.createElement("div",{class:"loader-line"})),h.a.createElement("div",{class:"loader-line-wrap"},h.a.createElement("div",{class:"loader-line"})),h.a.createElement("div",{class:"loader-line-wrap"},h.a.createElement("div",{class:"loader-line"}))):null}}]),t}(i.Component))||n),P=function(e){function t(){return T()(this,t),j()(this,I()(t).apply(this,arguments))}return A()(t,e),B()(t,[{key:"render",value:function(){var e=this.props.route;return h.a.createElement("div",null,h.a.createElement("div",{className:"content"},Object(c.b)(e.routes)),h.a.createElement(L,null))}}]),t}(i.Component),R=a(29),M=a.n(R),F=a(12),H=a.n(F),W=a(23),q=a.n(W),G=(a(123),function(e,t){switch(t){case"table":e="".concat(e,"-table");break;case"history":e="".concat(e,"-history")}return localStorage.getItem(e)}),J=function(e,t){return localStorage.setItem(e,t)},K=function(e,t){var a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1e4;return Promise.race([fetch(e,t),new Promise(function(e){setTimeout(function(){e("time out"+a)},a)})])},U=function(e){var t=document.createElement("div");t.className="message",t.style="\n        white-space: nowrap;\n        font-size: 10px;\n        position: absolute;\n        height: 5vh;\n        line-height: 5vh;\n        background-color: black;\n        color: #fff;\n        text-align: center;\n        border-radius: 6px;\n        padding: 5px 0;\n        opacity: 0.85;\n        width: 65vw;\n        bottom: 0;\n        right: 0;\n        left: 0;\n        top: 0;\n        margin: auto;\n    ",t.innerText=e,document.body.appendChild(t),t.addEventListener("animationend",function(){t.parentElement.removeChild(t)})},V=a(101),$=a.n(V),Q=function(e){function t(){return T()(this,t),j()(this,I()(t).apply(this,arguments))}return A()(t,e),B()(t,[{key:"shouldComponentUpdate",value:function(e){return e.tableState.toString()!==this.props.tableState.toString()}},{key:"render",value:function(){var t=this,e=this.props,o=e.bookTable,r=e.tableState;if(!o)return null;var a=window.screen.height,n=window.screen.width,i=parseInt(a)/16;return h.a.createElement("div",{onClick:function(e){return t.props.handleTableClick(e)}},h.a.createElement($.a,{height:a,rowCount:o.length,rowHeight:i,width:.7*n,rowRenderer:function(e){var t=e.index,a=e.key,n=e.style;return h.a.createElement("div",{key:a,style:v()({},n,{lineHeight:"".concat(i,"px"),borderBottomStyle:"dotted",borderWidth:"2px",borderColor:"lightgrey",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}),tableLength:o[t].length,tableKey:t},h.a.createElement("div",{style:{width:5,height:5,backgroundColor:1==r[t]?"lightseagreen":"lightslategray",borderRadius:5,marginRight:"5px",marginLeft:"15px",display:"inline-block"}}),h.a.createElement("span",null,o[t].title))},style:{backgroundColor:"white",opacity:.95}}))}}]),t}(i.Component),X=function(e){function t(){return T()(this,t),j()(this,I()(t).apply(this,arguments))}return A()(t,e),B()(t,[{key:"render",value:function(){var e=this.props,t=e.bookData,a=e.modelState,n={backgroundColor:"白天"===a?"antiquewhite":"black",color:"白天"===a?"black":"white",fontSize:e.contentFont,whiteSpace:"pre-wrap",paddingLeft:8,minHeight:"100vh"};return t&&h.a.createElement("div",{style:n,dangerouslySetInnerHTML:{__html:t}})}}]),t}(i.PureComponent),Y=function(e){function a(e){var t;return T()(this,a),(t=j()(this,I()(a).call(this,e))).state={setOpen:!1},t}return A()(a,e),B()(a,[{key:"onSetClick",value:function(e){for(var t=e.target;!t.getAttribute("data-set");){if("read_set"===t.className)return;t=t.parentNode}var a=t.getAttribute("data-set");"设置"===a?this.setState({setOpen:!this.state.setOpen}):(0,this.props.handleSetClick)(a)}},{key:"render",value:function(){var t=this,e=this.props,a=e.tableTitle,n=e.modelState,o=e.handleChangeClick,r=e.handleFontChange,i=this.state.setOpen,l=[{text:"目录",html:"#icon-mulu"},{text:"夜晚",html:"#icon-qingtianyewan"},{text:"白天",html:"#icon-tianqitubiao_qingtianbai"},{text:"下载",html:"#icon-xiazai"},{text:"设置",html:"#icon-shezhi"}].map(function(e,t){return"白天"!==e.text&&"夜晚"!==e.text||e.text!==n?h.a.createElement("div",{style:{display:"flex",flexFlow:"column",alignItems:"center"},key:t,"data-set":e.text},h.a.createElement("span",{style:{lineHeight:0}},h.a.createElement("svg",{class:"icon","aria-hidden":"true",dangerouslySetInnerHTML:{__html:'<use xlink:href="'.concat(e.html,'"></use>')}})),h.a.createElement("span",{style:{fontSize:10}},e.text)):null});return h.a.createElement("div",null,h.a.createElement("div",{style:{width:"100vw",height:"7vh",lineHeight:"7vh",backgroundColor:"black",opacity:.75,fontSize:14,textAlign:"center",color:"white"}},a),h.a.createElement("div",{style:{marginTop:"35vh",display:"flex",flexFlow:"row",justifyContent:"space-between",width:"100vw",height:"6vh",fontSize:18,fontWeight:100,color:"white",opacity:.8,visibility:"hidden"}},h.a.createElement("div",{style:{backgroundColor:"black",padding:5,borderRadius:"0 5px 5px 0",visibility:"visible"},onClick:function(){return o("last")}},"上一章"),h.a.createElement("div",{style:{backgroundColor:"black",padding:5,borderRadius:"5px 0 0 5px",visibility:"visible"},onClick:function(){return o("next")}},"下一章")),h.a.createElement("div",{style:{position:"fixed",bottom:"9vh",display:!0===i?"flex":"none",alignItems:"center",justifyContent:"space-around",height:"6vh",width:"100vw",backgroundColor:"black",color:"white",opacity:.8},onClick:function(e){return r(e)}},h.a.createElement("div",{"data-font":"+"},"+"),h.a.createElement("div",{"data-font":"-"},"-")),h.a.createElement("div",{style:{position:"fixed",bottom:0,display:"flex",alignItems:"center",justifyContent:"space-around",height:"9vh",width:"100vw",backgroundColor:"black",color:"white",opacity:.9},className:"read_set",onClick:function(e){return t.onSetClick(e)}},l))}}]),a}(i.PureComponent),Z=(a(196),a(197),"https://www.ijosser.com/api/"),ee={getBookInitData:Z+"getBookInitData?bookNumber=",getBookData:Z+"getBookData",searchBook:Z+"getBookNumber?bookName=",downloadBook:"//47.103.12.134:4536"},te=a(102),ae=a(198),ne=function(e){return{type:y,payload:e}},oe=function(e){return Object(b.bindActionCreators)({loadingChange:ne},e)},re=Object(d.connect)(function(e){var t=e.init;return{localDb:t.localDb,storageProps:t.storageProps}},oe)(o=function(e){function a(e){var t;return T()(this,a),(t=j()(this,I()(a).call(this,e))).state={readingBookName:decodeURI(new RegExp(/[?&]bookName=([^&]+)/g).exec(window.location.href)[1]),bookNumber:new RegExp(/[?&]bookNumber=([^&]+)/g).exec(window.location.href)[1],readingData:null,modelState:"白天",setShowState:!1,bookTable:[],contentFont:28,controller:null},t}var o,t,n,r;return A()(a,e),B()(a,[{key:"componentDidMount",value:function(){var e=this.props.storageProps,t=this.state.readingBookName,a=this.getLocalbookNumber(t,e);a?this.fetchLocalData(a):this.fetchBookInitData()}},{key:"fetchLocalData",value:function(e){var t=this.getBookRecord(e),a=t.lastReadHistory,n=t.tableState;n?(a||(a=1e5),this.getDbInitData(e,n,a)):this.fetchBookInitData()}},{key:"getDbInitData",value:function(o,r,i){var l=this;if(this.checkReadingTableState(i,r)){var e=new Promise(function(t){var e=o;l.getTableData(e).then(function(e){t(e?e.data:null)})});Promise.all([this.getDbBookData(o,i),e]).then(function(){var t=q()(H.a.mark(function e(t){var a,n;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t[1]){e.next=2;break}return e.abrupt("return",l.fetchBookInitData());case 2:if(t[0]){e.next=11;break}return a=parseInt(i)-1e5,e.next=6,l.fetchBookData(t[1][a].href,null,l.state.bookNumber);case 6:if((n=e.sent).bookData)return l.setTableBookData(n.bookData),e.abrupt("return",l.setReactState(n.bookData,t[1],o,r,i));e.next=10;break;case 10:return e.abrupt("return",l.setReactState("网络异常，服务器无法获取数据",t[1],o,r,i));case 11:return e.abrupt("return",l.setReactState(t[0],t[1],o,r,i));case 12:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}())}else this.fetchBookInitData()}},{key:"getDbBookData",value:function(a,n){var o=this;return new Promise(function(t){var e=1e6*a+parseInt(n);o.getTableData(e).then(function(e){t(e?e.data:null)})})}},{key:"fetchBookAllData",value:(r=q()(H.a.mark(function e(){var t,a,n,o,r,i,l;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.updateStorageTableState.tableState,a=this.state,n=a.bookTable,o=a.localBookNumber,r=200;case 3:if(!(r<220)){e.next=14;break}if(1==t[r])return e.abrupt("continue",11);e.next=6;break;case 6:return i=n&&n[r].href,e.next=9,this.fetchBookData(i);case 9:(l=e.sent).bookData?(this.setTableBookData(l.bookData,1e6*o+r+1e5),this.updateStorageTableState(r,o)):console.log(l);case 11:r++,e.next=3;break;case 14:case"end":return e.stop()}},e,this)})),function(){return r.apply(this,arguments)})},{key:"fetchBookData",value:function(e,t){var a,n,o,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this.state.bookNumber;return a=r,n=e,o=t,K("".concat(ee.getBookData,"?bookNumber=").concat(a,"&bookHref=").concat(n),{mode:"cors",signal:o},1e4).then(function(e){return e.json?e.json():e})}},{key:"getLocalbookNumber",value:function(e,t){return t&&e&&t[e]||!1}},{key:"setReadHistory",value:function(e,t){J("".concat(e,"-history"),t)}},{key:"getBookRecord",value:function(e){return{lastReadHistory:G(e,"history"),tableState:G(e,"table")?G(e,"table").split(","):null}}},{key:"getTableData",value:(n=q()(H.a.mark(function e(t){var a;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.props.localDb.getTable(t);case 3:a=e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:return e.abrupt("return",a);case 10:case"end":return e.stop()}},e,this,[[0,6]])})),function(e){return n.apply(this,arguments)})},{key:"fetchBookInitData",value:(t=q()(H.a.mark(function e(){var a,n,o;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t=this.state.bookNumber,K("".concat(ee.getBookInitData).concat(t),{mode:"cors"},1e4).then(function(e){return e.json?e.json():e});case 2:200===(a=e.sent).code&&a.table&&a.bookData&&(1e5,n=this.initDbTable(a.table.bookList),o=this.initStorageTableState(n,a.table.bookList.length),this.setReadHistory(n,1e5),this.setTableBookData(a.bookData.bookData,1e5+1e6*n),this.setReactState(a.bookData.bookData,a.table.bookList,n,o,1e5));case 4:case"end":return e.stop()}var t},e,this)})),function(){return t.apply(this,arguments)})},{key:"initDbTable",value:function(e){var t,a,n=this.props.storageProps,o=this.state,r=o.readingBookName,i=o.bookNumber;if(n){var l,s=n.length;a=1e3+(s+=1),t=Object.assign({},n,(l={length:s},M()(l,r,a),M()(l,a,i),l)),J("localBooks",JSON.stringify(t))}else{var c;a=1001,c={},M()(c,r,a),M()(c,a,i),M()(c,"length",1),t=c,J("localBooks",JSON.stringify(t))}return this.setTable(a,e),a}},{key:"initStorageTableState",value:function(e,t){var a=new Array(t).fill(0);return J("".concat(e,"-table"),a),this.updateStorageTableState(0,e)}},{key:"updateStorageTableState",value:function(e,t){var a=G(t,"table");return a&&(a=a.split(",")),a[e]=1,J("".concat(t,"-table"),a),a}},{key:"setTableBookData",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1e6*this.state.localBookNumber+parseInt(this.props.readingTableNumber);this.setTable(t,e)}},{key:"checkReadingTableState",value:function(e,t){return 0!==t[parseInt(e)-1e5]}},{key:"setTable",value:function(e,t){this.props.localDb.setTable({tableNumber:e,data:t})}},{key:"setReactState",value:function(e,t,a,n,o){this.setState({readingData:e,bookTable:t,localBookNumber:a,tableState:n,readingTableNumber:o})}},{key:"onTableChange",value:function(t){var a=this,e=this.state,n=e.bookTable,o=e.tableState,r=e.localBookNumber,i=t-1e5;if(!(i<0||i>o.length)){var l=1e6*r+t;"1"==o[i]?this.getTableData(l).then(function(e){e?a.fetchTableData(t,e.data):a.fetchTableData(t,null,n[i].href,i)}):this.fetchTableData(t,null,n[i].href,i)}}},{key:"handleTableOpen",value:function(){-1!==this.refs.tableWrap.className.indexOf("close")&&(this.refs.tableWrap.className=this.refs.tableWrap.className.replace("close","open"),this.refs.tableWrap.style.transition="transform 0.3s",this.refs.tableWrap.style.transform="translate(70vw, 0)")}},{key:"handleTableClose",value:function(){-1!==this.refs.tableWrap.className.indexOf("open")&&(this.refs.tableWrap.className=this.refs.tableWrap.className.replace("open","close"),this.refs.tableWrap.style.transition="transform 0.5s",this.refs.tableWrap.style.transform="translate(-70vw, 0)")}},{key:"handleTableClick",value:function(e){var t=e.target.getAttribute("tableKey")?e.target.getAttribute("tableKey"):e.target.parentNode.getAttribute("tableKey"),a=parseInt(t)+1e5;this.onTableChange(a)}},{key:"fetchTableData",value:(o=q()(H.a.mark(function e(t,a,n,o){var r,i,l,s,c,u,h;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.state,i=r.tableState,l=r.localBookNumber,s=r.controller,c=this.props.loadingChange,a){e.next=19;break}return c(!0),s&&s.abort(),s=window.AbortController?new window.AbortController:{},u=s?s.signal:null,e.next=9,this.fetchBookData(n,u);case 9:if(h=e.sent,c(!1),!(a=h.bookData)){e.next=17;break}i=this.updateStorageTableState(o,l),this.setTableBookData(a,1e6*l+parseInt(o)+1e5),e.next=19;break;case 17:return console.log("资源加载失败"),e.abrupt("return");case 19:this.handleTableClose(),this.setState({readingData:a,tableState:i,readingTableNumber:t,controller:s,setShowState:!1},function(){return window.scrollTo(0,0)});case 21:case"end":return e.stop()}},e,this)})),function(e,t,a,n){return o.apply(this,arguments)})},{key:"updateTableState",value:function(){var e=this.getBookRecord().tableState;this.setState({tableState:e})}},{key:"downloadAllBook",value:function(){var e,t,n=this,a=this.state,o=a.bookNumber,r=a.tableState,i=a.localBookNumber,l=a.bookTable;(e=o,t=new WebSocket("ws://".concat(ee.downloadBook)),te.Observable.create(function(o){t.onopen=function(){t.send(JSON.stringify({event:"downloadBook",data:{bookNumber:e}})),t.onmessage=function(e){var t=e.data,a=new FileReader;a.readAsArrayBuffer(t),a.onload=function(e){var t=e.target.result;if("[object ArrayBuffer]"===Object.prototype.toString.apply(t)){try{t=ae.inflate(t)}catch(e){console.log(e)}var a=new TextDecoder("utf-8").decode(new Uint8Array(t)).split("|"),n=JSON.parse(a);o.next(n)}}}}})).subscribe({next:function(e){var t=e.type,a=e.data;switch(t){case"bookData":a.map(function(e){var t=e.tableOffset,a=e.tableData;"0"===r[t]&&(r=n.updateStorageTableState(t,i),n.setTableBookData(a,1e6*i+1e5+t)),n.setState({tableState:r})});break;case"bookState":console.log(a);break;case"bookTable":l.length!==a.length&&n.setState({bookTable:l})}}})}},{key:"handleContentClick",value:function(){this.state.setShowState&&-1!==this.refs.tableWrap.className.indexOf("open")?this.handleTableClose():this.setState({setShowState:!this.state.setShowState})}},{key:"handleChangeClick",value:function(e){var t=this.state.readingTableNumber;if("next"===e){var a=parseInt(t)+1;this.onTableChange(a)}else if("last"===e){var n=t-1;this.onTableChange(n)}}},{key:"handleSetClick",value:function(e){switch(e){case"目录":-1!==this.refs.tableWrap.className.indexOf("open")?this.handleTableClose():this.handleTableOpen();break;case"夜晚":this.setState({modelState:"夜晚"});break;case"白天":this.setState({modelState:"白天"});break;case"下载":this.downloadAllBook()}}},{key:"handleFontChange",value:function(e){var t=e.target,a=this.state.contentFont;"+"===t.getAttribute("data-font")?this.setState({contentFont:++a}):this.setState({contentFont:--a})}},{key:"render",value:function(){var e,t=this,a=this.state,n=a.readingData,o=a.bookTable,r=a.modelState,i=a.setShowState,l=a.contentFont,s=a.tableState,c=a.readingTableNumber,u="loading";return n&&(u=n),o&&c&&(e=o[parseInt(c)-1e5].title),n?h.a.createElement("div",null,h.a.createElement("div",{style:{position:"fixed",height:0,width:0}},i&&h.a.createElement(Y,{modelState:r,tableTitle:e,handleChangeClick:this.handleChangeClick.bind(this),handleSetClick:this.handleSetClick.bind(this),handleFontChange:this.handleFontChange.bind(this)})),h.a.createElement("div",{className:"read_content",onClick:function(){return t.handleContentClick()}},h.a.createElement(X,{bookData:u,modelState:r,contentFont:l})),h.a.createElement("div",{ref:"tableWrap",className:"read_table close"},h.a.createElement(Q,{bookTable:o,tableState:s,handleTableClick:this.handleTableClick.bind(this)}))):null}}]),a}(i.Component))||o,ie=Object(d.connect)(function(e){var t=e.init;return{localDb:t.localDb,storageProps:t.storageProps}},oe)(r=function(e){function a(e){var t;return T()(this,a),(t=j()(this,I()(a).call(this,e))).state={searchData:null},t}return A()(a,e),B()(a,[{key:"handleSearch",value:function(){var t=this,e=this.refs.searchBtn,a=this.props.loadingChange;a(!0),e.blur();var n,o=e.value.replace(/^\s+|\s+$/g,"");(n=o,K("".concat(ee.searchBook).concat(n),{mode:"cors"},1e4).then(function(e){return e.json?e.json():e})).then(function(e){a(!1),0===e.length?U("找不到该书"):"[object String]"===Object.prototype.toString.apply(e)?U("系统超时，请稍后尝试"):t.setState({searchData:e})})}},{key:"handleLocalBookChange",value:function(){var e=this.props.storageProps;if(console.log(e),e&&e.length){var t=this.refs,a=t.localList,n=t.localIcon,o=a.getAttribute("data-state");n.style.transform="open"==o?(a.style.transition="transform 0.3s ease 0s",a.style.transform="translate(0vw, 0px)",a.setAttribute("data-state","close"),n.style.transition="transform 1s ease 0s","rotate(0deg)"):(a.style.transition="transform 0.3s ease 0s",a.style.transform="translate(80vw, 0px)",a.setAttribute("data-state","open"),n.style.transition="transform 1s ease 0s","rotate(180deg)")}else U("本地没有书籍！")}},{key:"handleClick",value:function(e){for(var t=e.target;"localWrap"!==t.className&&!t.getAttribute("data-bookNumber");)t=t.parentNode;var a=t.getAttribute("data-bookName"),n=t.getAttribute("data-bookNumber");n&&a&&this.props.history.push("/read?bookName=".concat(a,"&bookNumber=").concat(n))}},{key:"render",value:function(){var e,t,a=this,n=this.state.searchData,o=this.props.storageProps;return n&&(e=le(n)),o&&(t=se(o)),h.a.createElement("div",{style:{backgroundImage:"url('/src/static/img/searchBackImg.png')",backgroundSize:"cover",minWidth:"100vw",minHeight:"100vh"}},h.a.createElement("div",{style:{top:"20vh",borderRadius:"24px",width:"70vw",margin:"0 auto",height:"50px",display:"flex",flexFlow:"row",position:"relative",justifyContent:"center"}},h.a.createElement("input",{ref:"searchBtn",type:"text",onKeyPress:function(e){13===e.charCode&&a.handleSearch()},placeholder:"搜索书名或作者名",style:{borderRadius:"24px",width:"80%",border:"none",fontSize:"16px"}}),h.a.createElement("span",{style:{fontSize:"24px",height:"50px",lineHeight:"50px",marginLeft:10},onClick:function(e){return a.handleSearch(e)}},h.a.createElement("svg",{class:"icon","aria-hidden":"true",dangerouslySetInnerHTML:{__html:'<use xlink:href="#icon-search"></use>'}}))),h.a.createElement("div",{style:{width:"90vw",margin:"30vh auto 0"},className:"localWrap",onClick:function(e){return a.handleClick(e)}},e),h.a.createElement("div",{ref:"localList","data-state":"close",style:{position:"relative",display:"flex",alignItems:"center",left:"-80vw"}},h.a.createElement("div",{className:"localWrap",onClick:function(e){return a.handleClick(e)},style:{display:"flex",flexFlow:"row",flexWrap:"wrap",width:"75vw",padding:"10px 2vw",justifyContent:"space-around",boxShadow:"1px 5px 10px grey",backgroundColor:"white",borderRadius:"0 20px 20px 0"}},t),h.a.createElement("div",{ref:"localIcon",className:"leftIcon",onClick:function(){return a.handleLocalBookChange()}})))}}]),a}(i.PureComponent))||r,le=function(e){return e.map(function(e,t){return h.a.createElement("div",{"data-bookNumber":e.bookNumber,"data-bookName":e.bookName,key:t,style:{marginTop:10,padding:"10px 10px",display:"flex",fontSize:"20px",borderRadius:"20px",backgroundColor:"white",alignItems:"center"}},h.a.createElement("div",null,h.a.createElement("img",{src:"/src/static/img/fm".concat(t%13,".jpeg"),width:100})),h.a.createElement("div",{style:{marginLeft:"5px",textIndent:"15px",height:"200px"}},h.a.createElement("p",{style:{fontSize:"18px",textOverflow:"ellipsis",whiteSpace:"nowrap",width:"200px",overflow:"hidden"}},e.bookName),h.a.createElement("p",{style:{fontSize:"13px",color:"darkgreen"}},"状态： ",e.bookState),h.a.createElement("div",{style:{whiteSpace:" pre-wrap",fontSize:14,height:140,overflow:"hidden"}},"简介： ",e.bookIntro)))})},se=function(e){var t=[];for(var a in e)isNaN(parseInt(a))&&"length"!==a&&t.push({bookName:a,bookNumber:e[e[a]]});return t.map(function(e,t){return h.a.createElement("div",{key:t,"data-bookNumber":e.bookNumber,"data-bookName":e.bookName},h.a.createElement("div",null,h.a.createElement("img",{src:"/src/static/img/fm".concat(t+1,".jpeg"),width:80,height:115,style:{display:"block"}}),h.a.createElement("p",{style:{fontSize:"14px",textAlign:"center",marginTop:3}},e.bookName)))})},ce=[{path:"/",component:P,exact:!1,routes:[{path:"/read",component:re,exact:!0},{path:"/search",component:ie,exact:!0}]}],ue=a(50),he=a(70),de=function(){function e(){T()(this,e),this.db=null}var t;return B()(e,[{key:"init",value:(t=q()(H.a.mark(function e(){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getLocalDb();case 2:return this.db=e.sent,e.abrupt("return",this);case 4:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"getLocalDb",value:function(){return new Promise(function(a,t){var n=window.indexedDB.open("dakebook");n.onerror=function(e){t(e)},n.onupgradeneeded=function(e){var t=e.target.result;t.objectStoreNames.contains("books")||t.createObjectStore("books",{keyPath:"tableNumber"}),a(t)},n.onsuccess=function(){var e=n.result;a(e)}})}},{key:"setTable",value:function(n){var o=this;return new Promise(function(e,t){o.checkSetData(n)||e({code:-1,msg:"item error"});var a=o.db.transaction(["books"],"readwrite").objectStore("books").add(n);a.onsuccess=function(){e({code:1,msg:"success"})},a.onerror=function(e){t({code:-2,data:e})}})}},{key:"setTables",value:function(o){var r=this;return new Promise(function(e,t){var a=r.db.transaction(["books"],"readwrite"),n=a.objectStore("books");o.map(function(e){n.add(e),a.onerror(function(){t({code:-3,msg:"setTables error"})})})})}},{key:"checkSetData",value:function(e){return"[object Number]"===Object.prototype.toString.apply(e.tableNumber)&&"[object String]"===Object.prototype.toString.apply(e.tableData)}},{key:"getTable",value:function(n){var o=this;return new Promise(function(e,t){var a=o.db.transaction(["books"],"readonly").objectStore("books").get(n);a.onerror=function(){t({code:-4,msg:"getTable error"})},a.onsuccess=function(){e(a.result)}})}},{key:"getTables",value:function(r,i){var l=this;return new Promise(function(a,t){try{var e=l.db.transaction(["books"],"readonly").objectStore("books").index("tableNumber"),n=IDBKeyRange.bound(r,i),o=[];e.openCursor(n).onsuccess=function(e){var t=e.target.result;t?(o.push(t.value),t.continue()):a(o)}}catch(e){t(e)}})}}]),e}(),be=function(o,e,r){var t=Object(c.a)(e,r.pathname).map(function(e){var t=e.route,a=e.match,n=t.component.loadData;return n?n(o,a,r):Promise.resolve(null)});return Promise.all(t)},pe=function(e){function a(e){var t;return T()(this,a),(t=j()(this,I()(a).call(this,e))).state={showChildren:!1,firstGetInfo:!0,lastPath:null,hasSetInit:!1},t}return A()(a,e),B()(a,[{key:"componentWillReceiveProps",value:function(e){var t=this,a=this.props,n=a.routes,o=a.store;a.location,a.children;e.location!==this.props.location&&be(o,n,e.location).then(function(){t.setState({nextlocation:e.location})})}},{key:"componentDidMount",value:function(){var e=this,t=this.props.store;if(!this.state.hasSetInit){var a=new de;a.init().then(function(){t.dispatch({type:k,payload:{db:a,localProps:JSON.parse(G("localBooks"))}}),e.setState({hasSetInit:!0})})}}},{key:"render",value:function(){var e=this,t=this.props,a=t.routes,n=t.store,o=t.location,r=t.children;this.state.firstGetInfo&&(this.props.initState?this.setState({showChildren:!0,firstGetInfo:!1,nextlocation:o}):be(n,a,o).then(function(){e.setState({showChildren:!0,firstGetInfo:!1,nextlocation:o})}));var i=this.state.showChildren&&this.state.hasSetInit&&this.state.nextlocation===this.props.location;return h.a.createElement(ue.a,{location:o,render:function(){return i?r:null},local:{}})}}]),a}(i.Component),fe=Object(he.a)(pe),me=function(e){var t,a,n=Object(E.a)(),o=(t=n,a=e,Object(b.createStore)(Object(f.connectRouter)(t)(C),a,Object(b.applyMiddleware)(p.a,Object(f.routerMiddleware)(t))));return h.a.createElement(d.Provider,{store:o},h.a.createElement(f.ConnectedRouter,{history:n},h.a.createElement(u.a,null,h.a.createElement(fe,{routes:ce,store:o,initState:e},Object(c.b)(ce)))))};window.__initState__?s.a.hydrate(me(window.__initState__),document.querySelector(".server-app")):s.a.render(me(),document.querySelector(".server-app"))}});